(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04b0b90f"],{"01ff":function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"a",(function(){return s}));e("b0c0");var i={javascript:{name:"JavaScript",editor:"javascript",default:"/**\n* 数据处理JavaScript脚本,方法名transform不可修改\n* 参数: data Object 输入数据\n* 返回值: data Object 输出数据\n*/\nfunction transform(data) {\n    // do somethings \n    return data;\n}"},groovy:{name:"Groovy",editor:"java",default:"/**\n* 数据处理Groovy脚本,方法名transform不可修改\n* 参数: data Object 输入数据\n* 返回值: data Object 输出数据\n*/\ndef transform(data) {\n    // do somethings \n    return data;\n}"}};function n(){var t=[];for(var a in i)t.push({name:i[a].name,value:a});return t}var s=n()},ec74:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t._self._c;return a("div",[a("a-card",{staticStyle:{"margin-bottom":"10px"},attrs:{bordered:!1,"body-style":{padding:"17px 24px"}}},[a("a-row",[t.scriptNameEdit?t._e():a("a-col",{staticStyle:{"font-size":"16px","font-weight":"bold",color:"rgba(0, 0, 0, 0.85)","padding-top":"4px"},attrs:{span:6}},[t._v(" "+t._s(t.modal.scriptName)+" "),a("a-icon",{attrs:{type:"edit"},on:{click:function(a){t.scriptNameEdit=!0}}})],1),t.scriptNameEdit?a("a-col",{attrs:{span:6}},[a("a-input-search",{attrs:{placeholder:"请输入脚本名称"},on:{search:t.saveScriptName},model:{value:t.modal.scriptName,callback:function(a){t.$set(t.modal,"scriptName",a)},expression:"modal.scriptName"}},[a("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[t._v("确定")])],1)],1):t._e(),a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:18}},[a("a-space",{attrs:{size:"small"}},[a("a-button",{staticStyle:{width:"75px"},on:{click:t.onClose}},[t._v(" 返回")]),a("a-button",{staticStyle:{width:"75px"},on:{click:function(a){t.showDebug=!t.showDebug}}},[t._v(" 调试")]),a("a-button",{staticStyle:{width:"75px"},attrs:{type:"primary"},on:{click:t.saveScript}},[t._v(" 保存")])],1)],1)],1)],1),a("a-row",{attrs:{gutter:12}},[a("a-col",{attrs:{span:t.showDebug?16:24}},[a("a-card",{attrs:{bordered:!1}},[a("monaco-editor",{ref:"ScriptContentEditor",attrs:{height:"72vh",minimap:!0,"auto-init":!1}})],1)],1),t.showDebug?a("a-col",{attrs:{span:8}},[a("script-debug-model",{ref:"ScriptDebugModel",attrs:{language:t.modal.scriptLanguage}})],1):t._e()],1)],1)},n=[],s=(e("2ca0"),e("ac1f"),e("1276"),e("0fea")),r=e("01ff"),o=e("2200c"),c=function(){var t=this,a=t._self._c;return a("a-card",{attrs:{title:"调试","body-style":{},bordered:!1}},[a("span",{attrs:{slot:"extra"},slot:"extra"},[a("a-button",{staticClass:"runBtn",attrs:{type:"primary",icon:"caret-right"},on:{click:t.runScript}},[t._v(" 运行")])],1),a("div",{staticStyle:{"padding-bottom":"5px"}},[t._v("输入参数")]),a("monaco-editor",{ref:"ParamContentEditor",attrs:{height:"28vh",language:"json"}}),a("div",{staticStyle:{padding:"5px 0",display:"grid","grid-template-columns":"auto auto","justify-content":"space-between"}},[a("span",{staticStyle:{"justify-self":"start"}},[t._v("运行结果")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.time>=0,expression:"time >= 0"}],staticStyle:{"justify-self":"end"}},[t._v("用时："+t._s(t.time)+"ms")])]),a("monaco-editor",{ref:"ResultContentEditor",attrs:{height:"28vh",language:"json"}})],1)},d=[],p={name:"ScriptDebugModel",components:{MonacoEditor:o["a"]},inject:["getScriptContent"],props:{language:{type:String,default:void 0}},data:function(){return{url:{test:"/api/script/test"},time:-1}},mounted:function(){this.$refs.ParamContentEditor.set("{}"),this.$refs.ResultContentEditor.set("")},methods:{runScript:function(){var t=this,a={language:this.language,script:this.getScriptContent(),param:this.$refs.ParamContentEditor.get()};a.param?a.script?Object(s["d"])(this.url.test,a).then((function(a){200===a.code?(t.$refs.ResultContentEditor.set(JSON.stringify(a.data.result)),t.$refs.ResultContentEditor.format(),t.time=a.data.time,t.$message.success("运行成功")):t.$message.error("运行失败: "+a.message)})):this.$message.warn("脚本不可为空"):this.$message.warn("输入参数不可为空")}}},u=p,l=e("2877"),m=Object(l["a"])(u,c,d,!1,null,"c31f39ae",null),f=m.exports,h=e("ca00"),g={name:"ScriptModel",components:{ScriptDebugModel:f,MonacoEditor:o["a"]},data:function(){return{title:"操作",visible:!1,showDebug:!1,scriptNameEdit:!1,modal:{},url:{info:"/api/script/info",add:"/api/script/add",update:"/api/script/update"},scriptLanguageMap:r["b"]}},provide:function(){var t=this;return{getScriptContent:function(){return t.$refs.ScriptContentEditor.get()}}},mounted:function(){var t=this,a=this.$route.params.scriptId;if(a.startsWith("new")){var e=a.split("-");this.modal={scriptName:"script_"+Object(h["d"])(5),scriptLanguage:e[1],scriptContent:this.scriptLanguageMap[e[1]].default},this.initEditorValue()}else Object(s["c"])(this.url.info,{scriptId:a}).then((function(a){t.modal=a.data,t.initEditorValue()}))},methods:{initEditorValue:function(){var t=this;this.$nextTick((function(){t.$refs.ScriptContentEditor.init(t.modal.scriptContent,t.scriptLanguageMap[t.modal.scriptLanguage].editor)}))},saveScriptName:function(){this.modal.scriptName?this.scriptNameEdit=!1:this.$message.warn("脚本名称不可为空")},saveScript:function(){var t,a=this;(this.modal.scriptContent=this.$refs.ScriptContentEditor.get(),this.modal.scriptContent)?(t=this.modal.scriptId?Object(s["e"])(this.url.update,this.modal):Object(s["d"])(this.url.add,this.modal),t.then((function(t){200===t.code?(a.modal.scriptId=t.data.scriptId,a.$message.success("保存成功")):a.$message.warning("保存失败")}))):this.$message.warn("脚本不可为空")},onClose:function(){this.$router.push({name:"scriptList"})}}},v=g,b=Object(l["a"])(v,i,n,!1,null,null,null);a["default"]=b.exports}}]);