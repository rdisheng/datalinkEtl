(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b308327"],{2909:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("6b75");function i(e){if(Array.isArray(e))return Object(a["a"])(e)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");function o(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=n("06c5");function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e){return i(e)||o(e)||Object(s["a"])(e)||r()}},"94a8":function(e,t,n){"use strict";n.r(t);n("b64b"),n("07ac");var a=function(){var e=this,t=e._self._c;return t("div",[t("a-row",{directives:[{name:"show",rawName:"v-show",value:!e.disableEdit,expression:"!disableEdit"}],staticStyle:{width:"100%","padding-bottom":"10px"}},[t("a-col",{attrs:{span:18}},[t("a-space",{attrs:{size:"small"}},[t("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.newItem}},[e._v("添加")]),t("a-upload",{attrs:{showUploadList:!1,beforeUpload:function(t){return e.checkFile(t,5,["xlsx"])},customRequest:e.customRequest},on:{change:e.handlerUpload}},[t("a-button",{attrs:{icon:"upload"}},[e._v("导入")])],1),t("a-button",{attrs:{icon:"download"},on:{click:function(t){return e.download(!1)}}},[e._v("导出")]),t("a-popconfirm",{attrs:{title:"删除选中点位？"},on:{confirm:e.removeBatch}},[t("a-button",{directives:[{name:"show",rawName:"v-show",value:e.selectedRowKeys.length>0,expression:"selectedRowKeys.length > 0"}],attrs:{type:"danger",icon:"delete"}},[e._v(" 删除选中("+e._s(e.selectedRowKeys.length)+") ")])],1)],1)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[t("a-button",{attrs:{type:"link",icon:"download"},on:{click:function(t){return e.download(!0)}}},[e._v("下载模板")])],1)],1),t("a-table",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading,size:"middle","row-selection":e.disableEdit?null:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},scroll:{y:400}},scopedSlots:e._u([e._l(Object.keys(e.fieldMap),(function(n,a){return{key:n,fn:function(i,o){return[o.editable?t("a-input",{key:n,staticStyle:{margin:"-5px 0"},attrs:{value:i,placeholder:Object.values(e.fieldMap)[a]},on:{change:function(t){return e.handleChange(t.target.value,o.key,n)}}}):[e._v(e._s(i))]]}}})),{key:"index",fn:function(t,n,a){return[e._v(" "+e._s(a+1)+" ")]}},{key:"action",fn:function(n,a){return[a.editable?[a.isNew?t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("确定")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1):t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.cancel(a.key)}}},[e._v("取消")])],1)]:t("span",[t("a",{on:{click:function(t){return e.toggle(a.key)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1)]}}],null,!0)})],1)},i=[],o=n("2909"),s=n("5530"),r=n("b85c"),d=(n("d3b7"),n("25f0"),n("4de4"),n("7db0"),n("159b"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("ca00")),c=n("0fea"),l={name:"SnmpPointsModel",props:{disableEdit:{type:Boolean,default:!1}},data:function(){return{loading:!1,data:[],selectedRowKeys:[],fieldMap:{oid:"OID",type:"读取方式"},columns:[{title:"#",dataIndex:"index",width:"10%",scopedSlots:{customRender:"index"}},{title:"OID",dataIndex:"oid",key:"oid",width:"40%",scopedSlots:{customRender:"oid"}},{title:"读取方式(GET/WALK)",dataIndex:"type",key:"type",width:"30%",scopedSlots:{customRender:"type"}}]}},mounted:function(){this.disableEdit||this.columns.push({title:"操作",key:"action",scopedSlots:{customRender:"action"}})},methods:{checkFile:d["a"],set:function(e){if(this.data=[],e){var t,n=1,a=Object(r["a"])(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;this.data.push({key:n++,oid:i.oid,type:i.type,editable:!1,isNew:!1})}}catch(o){a.e(o)}finally{a.f()}}},get:function(){var e,t=[],n=Object(r["a"])(this.data);try{for(n.s();!(e=n.n()).done;){var a=e.value;a.isNew||t.push({oid:a.oid,type:a.type})}}catch(i){n.e(i)}finally{n.f()}return t},newItem:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),oid:"",type:"GET",editable:!0,isNew:!0})},remove:function(e){this.data=this.data.filter((function(t){return t.key!==e})),this.selectedRowKeys=this.selectedRowKeys.filter((function(t){return t!==e}))},removeBatch:function(){var e=this;this.data=this.data.filter((function(t){return-1===e.selectedRowKeys.indexOf(t.key)})),this.selectedRowKeys=[]},saveRow:function(e){this.loading=!0;var t=e.key,n=e.oid,a=e.type;if(!n||!a)return this.loading=!1,void this.$message.error("填写不完整");if("GET"!==a&&"WALK"!==a)return this.loading=!1,void this.$message.error("读取方式必须是GET或WALK");var i=this.data.find((function(e){return e.key===t}));i.editable=!1,i.isNew=!1,this.loading=!1},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(s["a"])({},t),t.editable=!t.editable},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,n){var a=Object(o["a"])(this.data),i=a.find((function(e){return t===e.key}));i&&(i[n]=e,this.data=a)},handlerUpload:function(e){if("done"===e.file.status)if(200===e.file.response.code){var t,n=e.file.response.data,a=this.data.length,i=a?parseInt(this.data[a-1].key):0,o=Object(r["a"])(n);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.key=(++i).toString(),s.editable=!1,s.isNew=!1,this.data.push(s)}}catch(d){o.e(d)}finally{o.f()}this.$message.success("已导入"+n.length+"个点位")}else this.$message.error("上传出错,".concat(e.file.response.message));else"error"===e.file.status&&this.$message.error("上传出错")},customRequest:function(e){var t=this,n=new FormData,a={};Object.keys(this.fieldMap).forEach((function(e){a[t.fieldMap[e]]=e})),n.append("file",e.file),n.append("field",JSON.stringify(a)),Object(c["f"])("/api/rule/points/import",n).then((function(t){e.onSuccess(t,e.file)}))},download:function(e){var t=e?[]:this.get(),n=e?"snmp_template.xlsx":"snmp_".concat(Object(d["c"])(),".xlsx");Object(c["b"])("/api/rule/points/export",{data:t,fieldMap:this.fieldMap,fileName:n}).then((function(e){var t=new Blob([e]),a=document.createElement("a"),i=window.URL.createObjectURL(t);a.href=i,a.download=decodeURIComponent(n),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(i)}))},onSelectChange:function(e){this.selectedRowKeys=e}}},u=l,f=n("2877"),p=Object(f["a"])(u,a,i,!1,null,null,null);t["default"]=p.exports}}]);